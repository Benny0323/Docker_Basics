# MyDocker
Docker 基础。 

![image-20210202223252532](assets/image-20210202223252532.png)

## 1.基本概念

+ ##### 什么是`Docker`?

  + 应用容器技术，操作系统层面的虚拟化技术
  + 通俗地可以这样理解（仅作为理解辅助，不用于技术解释）
    + 和`VM`之类的虚拟机技术做对比，`VM`是系统级别的虚拟技术，安装好的虚拟系统拷走镜像，在另一台机器上可以用`VM`打开，系统还是那个系统，一模一样。
    + 而`Docker` “虚拟”的大小比系统小，它只是“虚拟”应用和相关环境，打包成镜像（可以理解为刻了一张光盘），然后把镜像拷贝走，在另一台机器上（`Windows`、`Linux`、`MAC`）的`Docker`里，可以正常运行。应用的环境一模一样。省去重新安装环境的时间。

+ ##### 为什么是`Docker`?

  + ###### 一致的运行环境，更轻松的迁移

    + **应对场景**：开发的时候，在本机测试环境可以跑，生产环境跑不起来

  + ###### 对进程进行封装和隔离(**进程级别隔离**)，容器与容器之间互不影响，更高的利用系统资源

    + **应对场景**：服务器自己的程序挂了，结果发现是别人程序出了问题把内存吃完了，自己程序因内存不足就挂了

  + ###### 可以通过镜像复制`N`多个环境一致的容器

    + **应对场景**：公司举行线上活动，为应对大量的流量，需要多部署几十台服务器

+ ##### `Docker`和虚拟机的区别

  + |       比较项目       |                 `VM`                 |             `Docker`              |
    | :------------------: | :----------------------------------: | :-------------------------------: |
    |       系统携带       |                 `√`                  |                `/`                |
    | 资源（内存）调用流程 | 虚拟内存->虚拟物理内存->真正物理内存 |    虚拟物理内存->真正物理内存     |
    |       磁盘占用       |                 `GB`                 |               `MB`                |
    |       启动速度       |                 分钟                 |                秒                 |
    |       安装管理       |            专门的运维技术            |          安装、管理方便           |
    |       应用部署       |               费时费力               |     从第二次部署开始轻松简捷      |
    |       系统依赖       |                 `/`                  | 需求相同或相似的内核，推荐`Linux` |


## 2.安装和启动服务

+ ###### 安装

  + `Windows`需要开启`Hyper-V`
    + 控制面板 → 程序 → 卸载程序 →启动或关闭`Windows`功能→`Hyper-V`(勾选)
    + 下载`exe`，然后安装到自己喜欢的目录
  + `Linux`
    + `Bash`安装
      + ❗ 生产环境不建议用这种方法，因为所有配置参数都是默认的，而且下载的是最新的版本
      + `curl -fsSL https://get.docker.com -o get-docker.sh`
      + `sudo sh get-docker.sh  --mirror Aliyun`
        + `--mirror Aliyun`，表示用阿里云镜像下载，加快速度
    + 其它安装方法官方教程：[传送门](https://docs.docker.com/engine/install/centos/)
  + 查看版本信息
    + `docker version`

+ ###### 运行服务

  + 启动服务
    + `systemctl start docker`
  + 设置开机启动
    + `systemctl enable docker`

+ ###### `docker`组设置

  + 新建`docker`组
    + `groupadd docker`
  + 将当前用户加入`docker`组
    + `usermod -aG docker $USER`
      + `-a`仅和`-G`一块使用，将用户添加到附属组群
      + `-G`，修改用户所属的附加群组
  + 重启`Docker`服务
    + `systemctl restart docker`

## 3. 核心概念

+ ###### 镜像（images）

  + `Docker`镜像，就相当于是一个`root` 文件系统。比如官方镜像 ubuntu:16.04 就包含了完整的一套 Ubuntu16.04 最小系统的 `root` 文件系统。
  + `Docker `镜像是用于创建 `Docker `容器的模板，比如 `Ubuntu` 系统。
  + **只读**

+ ###### 容器（`container`）

  + 容器是独立运行的一个或一组应用，是镜像运行时的实体。
  + 一个镜像可以被产生`n`个容器，就代表`n`个实例
  + **可读写**

+ ###### 仓库（`repository`）

  + 保存镜像的远程位置

## 4. 使用

+ ###### 从`DockerHub`中找镜像并下载（以`mysql`为例）

  + 在`DockerHub`中搜索`mysql`
  + 下载最新版镜像
    + `docker pull mysql`
  + 如果下载指定版镜像
    + `docker pull mysql:5.6.51`

+ ###### `docker`镜像加速

  + 登录阿里云→容器镜像服务→镜像中心→镜像加速器
  + 然后选择相应的系统，下边会有对应的代码，复制执行即可
  + 查看镜像是否设置成功
    + `docker info`查看信息中，有如下图，则为设置成功
    + ![image-20210203222421924](assets/image-20210203222421924.png)

  + 加速效果很明显

+ ###### 运行容器

  + `docker run hello-world`

    + `hello-world`，镜像名称

  + ###### 容器运行流程

    + 若本地没有发现`hello-world`镜像，则会从远程下载名为`hello-world`的镜像
    + 然后以镜像为模板生成一个容器

## 5.`Docker`相关操作

+ ##### `docker `引擎

  + ###### `CS`架构

    + `C`，`client`
    + `S`，`Server`
    + 可以用其它客户端操作`docker`服务

  + ###### `docker info`，显示`docker`信息

  + ###### `docker version`，主要用于查看`docker`版本信息

+ ##### 镜像相关命令

  + ###### `docker images`，查看本地镜像的相关信息

    + ![image-20210203224822045](assets/image-20210203224822045.png)
    + `CREATED`，镜像的创建时间，不是下载时间

  + ###### 拉取镜像方法

    + ###### 根据版本拉取

      + `docker pull mysql:5.6.51`

    + ###### 根据摘要拉取

      + `docker pull mysql:@DIGEST:sha256:1c224b6270c6a02f9e7eb9e4ca6486d3466f12be7390c0c0b6e6f908ea1a0346`
      + ![image-20210203225533063](assets/image-20210203225533063.png)

  + ##### 通过命令行搜索相关的镜像

    + `docker search resdis`
      + 和网页搜索是一样的效果
      + ![image-20210203225640933](assets/image-20210203225640933.png)

  + 7.7-00:19:56

